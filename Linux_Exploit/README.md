According to the [Armis researches](https://www.armis.com/blueborne/):
> All Linux devices running BlueZ are affected by the information leak vulnerability (CVE-2017-1000250).

> All Linux devices from version 2.6.32 (released in July 2009) until version 4.14 are affected by the remote code execution vulnerability (CVE-2017-1000251)


List of infected kernel versions : [here](https://www.securityfocus.com/bid/100809)

According to [wiki.ubuntu.com](https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/BlueBorne):
> Ubuntu 14.04 LTS, Ubuntu 16.04 LTS, and Ubuntu 17.04 were affected

So I installed a 16.04.03 Ubuntu in Virtualbox and I downgraded the Linux Kernel to version 4.13 following this [guide](http://ubuntuhandbook.org/index.php/2017/09/install-linux-kernel-4-13-ubuntu-16-04-higher/).

You can verify if you succeded taping:
```
uname -r
4.13.0-041300-generic
``` 
Then you will need a Ubuntu package for Bluez with a version before `5.37-0ubuntu5.1` (because this version fix the CVE-2017-1000250 according to [Ubuntu bluez package](https://launchpad.net/ubuntu/+source/bluez/5.37-0ubuntu5.1))
So if you get:
```
dpkg --status bluez | grep '^Version:'
Version: 5.37-0ubuntu5.1
instead of 
Version: 5.37-0ubuntu5
``` 
Then you need to downlad and install the [previous version](https://launchpad.net/ubuntu/+source/bluez/5.37-0ubuntu5)
```
sudo apt-get install bluez=5.37-0ubuntu5
```
or manually:
```
Download
============================
wget https://launchpad.net/ubuntu/+archive/primary/+files/bluez_5.37.orig.tar.xz
tar xf bluez_5.37.orig.tar.xz
or
https://launchpad.net/ubuntu/+archive/primary/+files/bluez_5.37-0ubuntu5.dscc
dpkg-source -x bluez_5.37-0ubuntu1.dsc

Compilation and installation
============================

In order to compile Bluetooth utilities you need following software packages:
  - GCC compiler
  - GLib library
  - D-Bus library
  - udev library (optional)
  - readline (command line clients)
sudo apt-get install gcc glib2.0 libdbus-1-dev libudev-dev libical-dev libreadline-dev

To configure run:
cd bluez-5.37/
./configure --prefix=/usr --mandir=/usr/share/man --sysconfdir=/etc --localstatedir=/var

Configure automatically searches for all required components and packages.

To compile and install run as root:
make && make install
```

On the victime, make sure the bluetooth is discoverable:
```
hciconfig  # must have at least 1 interface
sudo bluetoothctl
  power on
  agent on
  discoverable on
```

In order to capture Bluetooth packets in Wireshark:
```
sudo apt-get install libpcap0.8 libpcap0.8-dev libpcap-dev
```
